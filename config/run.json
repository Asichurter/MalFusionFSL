{
  "task": {
    "dataset": "virushare-20-3gram-tfidf",

    "k": 5,
    "n": 5,
    "qk": 15,

    "version": 1,

    "device_id": 3
  },

  "training": {
    "epoch": 3e4
  },

  "description": [
      "使用任务batch=2",
      "使用300维度的GloVe初始化",
      "序列长度为200使用了tfidf的3Gram(最终分割)",
      "提前终止的标准改为loss",
      "修改了数据集的存储方式，使得数据集中所有向量都是以最大序列长度存储",
      "使用1层BiLSTM编码,使用1dCNN解码",
      "不使用LayerNorm",
      "初始学习率设置为1e-3"
  ],

  "model": {
    "modelName" :  "ConvProtoNet",

    "embedding": {
      "use_pretrained": true,
      "embed_size": 300
    },

    "conv_backbone": {
      "conv_type": "conv-4",
      "channels": [1,32,64,128,256],
      "kernel_sizes": [3,3,3,3],
      "padding_size": [1,1,1,1],
      "strides": [2,1,1,1]
    },

    "LSTM": {
      "bidirectional": true,
      "hidden_size" : 128,
      "layer_num" : 1,
      "max_seq_len": 300,

      "self_attention": {
        "self_att_enable": false,
        "self_att_type": "custom",
        "self_att_dim": null,

        "self_att_params": {
          "multi_head_att_head_num": 4
        }
      }
    },

    "regularization" : {
      "dropout": 0.5
    },

    "more": {
      "temperature": 1
    },

    "cluster": {
      "cluster_num_step": 1
    },

    "model_feature": {
      "feat": {
        "set_to_set_func": "transformer",
        "contrastive_factor": 0.1,
        "avg": "post",
        "deepset_hidden_dim": 128,
        "trans_dropout": 0.5,
        "trans_head_nums": 1
      }
    },

    "data_parallel": {
      "data_parallel": false,
      "data_parallel_devices": null
    }
  },

  "validate": {
    "val_cycle": 100,
    "val_episode": 100,

    "early_stop": {
      "criteria": "loss",
      "save_latest": true
    }
  },

  "optimize": {
    "loss_function": "nll",
    "optimizer": "sgd",
    "default_lr": 1e-3,
    "custom_lrs": {},
    "weight_decay": 5e-4,
    "task_batch": 2,

    "scheduler": {
      "lr_decay_iters": 15000,
      "lr_decay_gamma": 0.1
    }
  },

  "visualization": {
    "use_visdom" : false,
    "record_gradient": false,
    "gradient_update_cycle": 1000,

    "plot" : {
      "types" : ["line", "line"],
      "titles": ["accuracy", "loss"],
      "xlabels" : ["iterations", "iterations"],
      "ylabels" : ["accuracy", "loss"],
      "legends" : [
                  ["train acc", "val acc"],
                  ["train loss", "val loss"]
      ]
    }
  }
}